# 项目架构

## 系统架构

FastAPI-Vue3-Sample 项目采用前后端分离的架构设计，由以下主要部分组成：

```
客户端 (浏览器) <---> 前端 (Vue 3) <---> 后端 API (FastAPI) <---> 数据库 (PostgreSQL)
```

### 架构说明

1. **前端层**：

   - 使用 Vue 3 框架构建用户界面
   - 通过 Axios 处理 HTTP 请求
   - 使用 Vite 作为构建工具
   - 组件化设计，便于维护和扩展

2. **后端层**：

   - 使用 FastAPI 提供 RESTful API
   - 采用 Pydantic 进行数据验证
   - 自动生成 OpenAPI 文档
   - 支持异步处理请求

3. **数据层**：
   - PostgreSQL 关系型数据库
   - SQLAlchemy ORM 进行数据库操作
   - 数据模型与业务逻辑分离

## 后端架构

### 目录结构

```
app/
├── configs/         # 配置文件
├── database/        # 数据库相关代码
├── models/          # 数据库模型定义
├── routes/          # API 路由
└── schemas/         # Pydantic 数据模型
```

### 主要组件

1. **应用初始化**：

   - `app/__init__.py`: 创建 FastAPI 应用实例
   - 加载环境变量、注册路由、初始化数据库

2. **数据库访问层**：

   - `app/database/`: 数据库连接和会话管理
   - `app/models/`: SQLAlchemy ORM 模型定义
   - 包含表结构、关系和数据操作方法

3. **API 路由层**：

   - `app/routes/`: 定义 API 端点
   - RESTful 设计风格
   - 支持依赖注入和路径参数

4. **数据验证层**：
   - `app/schemas/`: Pydantic 模型
   - 请求和响应数据验证
   - 数据序列化/反序列化

## 前端架构

### 目录结构

```
frontend/
├── components/     # Vue 组件
└── services/       # API 服务和工具函数
```

### 主要组件

1. **UI 组件**：

   - `frontend/components/`: Vue 3 组件
   - 采用组合式 API (Composition API)
   - 组件化、可复用的 UI 元素

2. **API 服务**：
   - `frontend/services/`: API 调用封装
   - 使用 Axios 处理 HTTP 请求
   - 处理错误和响应数据格式化

## 数据流

在该应用中，数据流动遵循以下路径：

1. 用户在 Vue 前端界面上执行操作（如创建产品）
2. 前端组件调用相应的 API 服务函数
3. API 服务通过 Axios 发送 HTTP 请求到后端
4. FastAPI 后端接收请求，进行数据验证
5. 后端使用 SQLAlchemy 执行数据库操作
6. 数据库返回结果到后端
7. 后端将结果序列化并返回给前端
8. 前端更新 UI 展示最新数据

## 部署架构

项目支持多种部署方式：

1. **开发环境**：

   - 使用 PDM 和 Python 虚拟环境
   - 前端使用 Vite 开发服务器
   - 后端使用 Uvicorn 运行 FastAPI

2. **Docker 部署**：

   - 使用 Docker Compose 编排服务
   - 包含应用容器和数据库容器
   - 环境变量配置实现灵活部署

3. **生产环境**：
   - 前端静态文件部署到 Web 服务器
   - 后端 API 通过 Uvicorn/Gunicorn 部署
   - 支持 HTTPS 和负载均衡

## 安全性考虑

1. **认证与授权**：

   - 可集成 JWT 认证
   - 角色基础的访问控制

2. **数据验证**：

   - 使用 Pydantic 进行请求数据验证
   - 输入数据清洗和类型检查

3. **SQL 注入防护**：

   - 使用 SQLAlchemy ORM 参数化查询
   - 避免直接拼接 SQL 字符串

4. **CORS 配置**：
   - 适当配置 Cross-Origin Resource Sharing
   - 控制允许的源和方法

## 扩展性

该架构设计支持以下扩展：

1. **添加新功能模块**：

   - 创建新的数据模型
   - 添加相应的 API 路由
   - 开发对应的前端组件

2. **集成其他服务**：

   - 支持添加第三方 API 集成
   - 可集成消息队列、缓存等中间件

3. **扩展认证方式**：
   - 支持 OAuth、SAML 等认证机制
   - 集成第三方认证服务
